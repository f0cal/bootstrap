{% set HERE = pillar['cli']['code_dir'] %}

repos_default:
  branch: dev
  lang: py3

repos:
  - name: my-device
    url: https://github.com/f0cal/my-device-mirror

  - name: my-code
    url: https://github.com/f0cal/my-code
    branch: master

  - name: farm
    url: https://github.com/f0cal/farm
    branch: master

  - name: device-farm
    url: https://github.com/f0cal/device-farm

  - name: core
    url: https://github.com/f0cal/core
    branch: master

  - name: saltbox
    url: https://github.com/f0cal/saltbox

  - name: salt
    url: https://github.com/f0cal/salt
    branch: f0cal

  - name: conan-recipes
    url: https://github.com/f0cal/conan-recipes

  - name: tests
    url: https://github.com/f0cal/test-suite

eggs:
  - repo: my-device
    name: f0cal.my-device

  - repo: my-code
    name: f0cal.my-code

  - repo: farm
    name: f0cal.farm.client

  - repo: device-farm
    name: f0cal.service.device_farm
    subdir: device_farm

  - repo: core
    name: f0cal
    subdir: f0cal

  - repo: core
    name: plugnparse
    subdir: plugnparse

  - repo: saltbox
    name: saltbox

  - repo: salt
    name: salt

tests_default:
  run: run-parts {{ HERE }}/tests/egg --arg {{ HERE }}/_venv

tests:
  - cwd: my-device

  - cwd: my-code

  - cwd: farm

  - cwd: device-farm
    run: run-parts {{ HERE }}/tests/repo

  - cwd: device-farm/device_farm

  - cwd: device-farm
    run: run-parts {{ HERE }}/tests/repo

  - cwd: core/plugnparse

  - cwd: core/f0cal

  - cwd: saltbox 
